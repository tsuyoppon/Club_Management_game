# Jリーグクラブ経営ゲーム v1 Spec（仕様書・初期パラメータ込み）

このドキュメントは「実装に入れる凍結ライン（v1）」として、ここまで合意した仕様を構造的・網羅的に整理したものです。係数は v1初期設定としてすべて記載（プレイテストで調整前提）。

---

## 0. 目的と前提

- 研修用途（不特定多数の常設Webゲームではない）
- 参加者最大30名程度、1ゲーム最大5クラブ、リモート参加可
- 1クラブに複数参加者を割り当て可能（ただし「入力できる担当者」は限定）
- ゲームマスター（管理者）が進行管理できる設計
- 基本はテキストベース（ターミナル/コンソール I/O）

---

## 1. ゲームの勝敗（評価）と終了条件

### 1.1 ゲーム終了条件（クラブ単位）

- 年度内で現金残高がマイナス（債務超過）になったクラブは、その年度でゲーム終了（脱落）
- 債務超過になった場合：
    - その年度のスケジュール通り試合参加は継続可
    - 勝点剥奪（剥奪幅は v1で固定：後述）
    - シーズン中の追加補強（追加強化費）禁止
- 年度終了時（7月終了）に脱落判定を確定

### 1.2 最終結果表示（ゲーム側で総合優勝者は決めない）

ゲーム終了時、全クラブに以下を提示（順位順表示画面も用意）：

- 売上規模（最終期）：金額＋順位
- 純資産（＝期末現金残高）：金額＋順位
- 成績：優勝回数、準優勝回数、平均順位
- ホームゲーム平均入場者数（全シーズン）：人数＋順位

---

## 2. 時間軸・ターン・イベント

### 2.1 年度とシーズン

- クラブ年度：8月〜7月（12ターン）
- シーズン（試合がある期間）：8月〜5月（10ヶ月）
- 6月：シーズン終了後処理（賞金提示・入金）
- 7月：年度終了処理（スポンサー最終確定・次年度見込み提示）

### 2.2 試合（マッチデイ）

- 原則：8月〜5月の各月に1試合（合計10試合）
- 対戦は参加クラブ同士のみ
- ホーム/アウェイあり（各クラブのホーム数とアウェイ数は同数になるようにスケジューリング）
- 各節終了ごとに順位表更新
- 試合のメンバー/戦術は意思決定スコープ外

### 2.3 主要イベント（年度内）

- **8月（年度開始）**：スポンサー収入＋配分金を一括計上
- **12月ターン終了**：前期財務サマリー（全クラブ）公開＋チーム力指標（全クラブ）再公開
- **5月**：採用イベント／解雇可能（同タイミング）
- **6月ターン終了**：当年度最終成績に基づく賞金額を表示＆入金
- **7月ターン終了**：次年度スポンサー契約数の最終確定＋次年度スポンサー収入見込み提示（入金は次年度8月）

---

## 3. 進行方式（非同期／同期）

### 3.1 原則

- 原則：非同期ターン（各プレイヤーが入力→確定。全クラブ確定が揃うと進行）
- オプション：完全同期モード（研修で同時進行したい場合）

### 3.2 ターンフロー（v1）

1. ターン開始表示（年月、試合があれば対戦相手とホーム/アウェイ）
2. 入力ステップ（コマンドで入力・修正）
3. `show current_input` で当ターン入力の確認可
4. `commit` 実行 → 入力内容を一覧表示 → “確定して良いか？”を Y/N
5. 全クラブ確定が揃い次第、試合月は試合実行へ（試合なし月は会計処理へ）
6. 試合直前情報表示（天候など詳細）
7. 試合結果・順位表・（必要なら）収益明細表示
8. “次ステップに進みますか？”を Y/N

---

## 4. 情報公開（完全情報／不完全情報）

### 4.1 毎節（試合月ターン終了後）

- 順位・勝点・得失点差（全クラブ公開）

### 4.2 チーム力指標（全クラブ公開）

- 7月ターン終了時：次シーズンのチーム力指標を公開（不確実性付き）
- 12月ターン終了時：チーム力指標を再公開（“最新”）

### 4.3 財務公開（全クラブ公開）

- 12月ターン終了時：全クラブの前期財務サマリー（PL/BS簡易）を公開

### 4.4 隠れ変数

- FB（ファンベース人数）は隠れ変数
- ただし、FBと強く相関する **公開指標（SNSフォロワー相当）**は参照可能

---

## 5. 入力（意思決定）項目

### 5.1 毎月入力（通年：8〜7月）

- 営業費用（当月）
- プロモーション費用（当月）
- ホームタウン活動費用（当月）

### 5.2 条件付き入力

- 翌月ホームゲーム向けプロモ費（入力可能月のみ）
    - 「ホームゲームがある月の前月」に投入できる
    - 入力可能でない月はエラー扱い
- 追加強化費（シーズン途中で1回のみ、12月想定）
    - 債務超過ペナルティ中は入力不可

### 5.3 年次（年度単位）入力

- 強化費（翌シーズン分）：前年度のシーズン終了期間（例：6月・7月）に決定
- アカデミー投資額：年1回（タイミングは v1：5月イベント時に翌年度分設定）
- 採用（翌年度開始時に入社）：5月イベントのみ
- 解雇：5月イベントのみ

### 5.4 営業リソース配分（四半期ごとに変更可）

- 人員数ではなく 総営業リソースの配分比率で管理（連続値OK）
- 新規配分 $\rho^{new} \in [0,1]$、既存は $1-\rho^{new}$
- 入力可能月：四半期開始月のみ（8/11/2/5月）
    - Q1: 8–10月、Q2: 11–1月、Q3: 2–4月、Q4: 5–7月

---

## 6. 参照コマンド（v1）

### 6.1 試合・順位

- `show match`：現シーズンの直近までの試合結果一覧
    - オプションで月指定可能（例：`--month 2026-04`）
- `show table`：直近節までの順位表

### 6.2 チーム力

- `show team_power`：最新のチーム力指標（7月 or 12月の最新公開値）

### 6.3 人員

- `show staff`：部署別人数
- `show staff_history --from --to`：採用/解雇を含む人員変動履歴（期間指定）

### 6.4 入力履歴

- `show current_input`：当ターン入力内容のみ
- `show history --from --to`：過去の入力一覧（期間指定、デフォルトは先月）

### 6.5 ファン規模指標（公開）

- `show fan_indicator`：全クラブの最新ファン指標（SNSフォロワー相当）
- `show fan_indicator --club <name>`
- `show fan_indicator --from --to`

### 6.6 スポンサー（モデル内部要因は非公開）

- `show sponsor_status`：当年度スポンサー数（最新確定値）
- `show sponsor_status --pipeline`：4〜6月の「次年度内定累計」（自クラブのみ）
- `show sponsor_status --next`：7月終了時に確定した次年度契約数＋次年度見込み収入（自クラブのみ）
- `help` / `help <command>`

※ `show sponsor_model`、`show fanbase`、`show hiring_chance` は削除（非公開方針）

---

## 7. 会計（収入・費用）計上タイミング

### 7.1 収入

- スポンサー収入：8月一括入金（次年度分は前年度7月に確定、8月に入金）
- 配分金（固定）：8月一括入金
- 入場料収入：ホームゲーム月に計上
    - 収入は ホーム来場者＋アウェイ来場者の合計をベースに算定
- 物販収入：ホームゲーム月に計上
- 賞金（成績）：6月ターン終了で表示＆入金
- アカデミー移籍金：7月（年1回、確率で発生）

### 7.2 費用

- 強化費：12ヶ月均等で支払い（毎月）
- 人件費：12ヶ月均等
- 管理費：12ヶ月均等
- アカデミー費用：12ヶ月均等（年次決定）
- 営業費用：入力した月に計上
- プロモ費用：入力した月に計上（翌月ホーム向けプロモも支出は入力月で計上）
- ホームタウン活動費：入力した月に計上
- 試合運営費：ホームゲーム月に計上
- 物販費用：ホームゲーム月に計上（売れた分の原価）
- 退職金：7月（解雇に伴う割増退職金含む）

---

## 8. 試合：勝敗・得点・順位

### 8.1 勝点

- 勝ち3、引き分け1、負け0

### 8.2 順位決定（優先順）

1. 勝点
2. 得失点差
3. 総得点
4. 直接対決の結果

### 8.3 勝敗確率モデル（ホームH vs アウェイA）

#### 8.3.1 有効レーティング差

$$ \Delta = ER_H - ER_A $$

#### 8.3.2 引き分け確率

$$ p_{draw} = d_0 \cdot \exp(-c|\Delta|) $$

- v1：$d_0=0.30, c=0.08$

#### 8.3.3 引き分け以外の勝敗バランス

$$ p_{H|no\_draw} = \frac{1}{1+\exp(-k\Delta)} $$

- v1：$k=0.15$

#### 8.3.4 最終3値確率

$$ p_H = (1-p_{draw})p_{H|no\_draw} $$
$$ p_A = (1-p_{draw})(1-p_{H|no\_draw}) $$

- v1ホームアドバンテージは TP→ERの段階で付与：$h=3$

### 8.4 チーム力（TP）の生成（強化費＋アカデミー）

$$ TP_i = \alpha \cdot \ln(1+\frac{B_i}{B_{ref}}) + \beta \cdot \ln(1+\frac{A^{cum}_i}{A_{ref}}) $$

- 強化費 $B_i$：当年の強化費（年額）
- アカデミー累積 $A^{cum}_i$：累積投資（減衰を入れるなら後で）

v1係数（要望反映）：
- $\alpha=10, \beta=1$

アカデミー累積の更新（v1）：
- 年次投資 $A_i^{year}$ を12分割で支出
- 累積は減衰あり（v1）：
  $$ A^{cum}_i \leftarrow \rho A^{cum}_i + A_i^{year} $$
- $\rho=0.5$

TP→ER（有効レーティング）：
- $ER_i = TP_i + HomeAdv + StreakAdj$
- HomeAdv：ホームなら $+h$（$h=3$）
- 連勝連敗補正：v1は簡易（例）
    - 連勝数 $s$：$+\min(2, 0.5s)$
    - 連敗数 $l$：$-\min(2, 0.5l)$

### 8.5 得点モデル（v1）

- 最大4点（あなたの設定）
- 勝敗が決まった後、点差分布でスコアを生成（詳細係数は次版で固定でも可）
    - v1実装は「勝ちなら1〜4点差を確率で、引分は0-0/1-1/2-2中心」などの簡易分布でOK
    - →詳細は末尾の”追記１：得点モデル詳細”を参照すること

---

## 9. 入場者数モデル → チケット収入（v1 係数確定）

### 9.1 固定（初期シナリオ共通）

- $Pop=1,000,000$
- $Cap=20,000$
- 初期ファンベース率 $f(0)=0.06 \to FB(0)=60,000$
- 上限 $f_{max}=0.25$
- チケット単価（全クラブ共通）$\bar P=2,500$円
- 天候確率：晴0.55 / 曇0.30 / 雨0.15
- 天候効果：$g_W(\text{晴})=0, g_W(\text{曇})=-0.2, g_W(\text{雨})=-0.6$

### 9.2 ホーム来場率

$$ r^{home}_{i,j}(t)=\sigma\Big( \beta_0+\beta_W g_W(W) +\beta_1 Perf_i(t)+\beta_2 HistPerf_i(t) +\beta_3\ln(1+\frac{Promo_{i\to t}}{S_{promo}}) +\beta_4\ln(\frac{FB_j(t)}{FB_{ref}}) +\beta_5 g_{event}(t) \Big) $$

v1定数：
- $FB_{ref}=60,000, S_{promo}=10,000,000$

v1係数：
- $\beta_0=-1.986$
- $\beta_W=1.0$
- $\beta_1=0.8$（今期順位：前月順位を使用）
- $\beta_2=0.4$（過去平均成績）
- $\beta_3=0.6$（前月ホーム向けプロモ）
- $\beta_4=0.3$（相手FB効果）
- $\beta_5=0.5$

イベント：
- 開幕戦・最終戦：$g_{event}=0.4$、通常0

ホーム来場者：
$$ A^{home}=\min(Cap, FB_i \cdot r^{home}) $$

### 9.3 アウェイ来場（天候影響は弱い）

- 基準遠征率：$r^{away}_0=0.018$
- 天候影響：$\kappa_W=0.20$
- 上限制約：$q_{max}=0.20$

$$ WeatherAdj=\exp(\kappa_W g_W(W)) $$
$$ A^{away}=\min(FB_j \cdot r^{away}_0 \cdot WeatherAdj,\ q_{max}\cdot Cap) $$

### 9.4 Cap超過時の比率縮小

$$ A^{raw}=A^{home}+A^{away} $$
$A^{raw}>Cap$ なら比率で縮小し合計をCapに合わせる。

### 9.5 チケット収入

$$ TicketRev = (A^{home}+A^{away})\cdot \bar P $$

### 9.6 FB更新（隠れ変数）

EWMA（最近重視）：$\lambda=0.10$

累積プロモ：
$$ C^{promo}(t)=(1-\lambda)C^{promo}(t-1)+\lambda PromoSpend(t) $$

累積ホームタウン（急変ペナルティ）：
$$ C^{ht}(t)=(1-\lambda)C^{ht}(t-1)+\lambda HTSpend(t)-\phi|\Delta HTSpend(t)| $$
- v1：$\phi=0.00002$

成長率（月次）：
- スケール：$S_{promo-growth}=50,000,000, S_{ht-growth}=50,000,000$

$$ g(t)=g_0 +a_1\ln(1+\frac{C^{promo}}{S_{promo-growth}}) +a_2\ln(1+\frac{C^{ht}}{S_{ht-growth}}) +a_3(Perf-0.5)+a_4(HistPerf-0.5) $$

v1係数：
- $g_0=-0.002$
- $a_1=0.006, a_2=0.006$
- $a_3=0.010, a_4=0.006$

上限接近で伸びにくく：
$$ g^{eff}=g(t)\left(1-\frac{f(t)}{f_{max}}\right) $$
$$ f(t+1)=clip(f(t)(1+g^{eff}),0,f_{max}) $$
$$ FB(t)=Pop\cdot f(t) $$

### 9.7 公開ファン指標（SNSフォロワー相当）

- 公開指標 Followers は FB と強相関＋誤差

$$ \ln(Followers_i(t))=\ln(\kappa_F\cdot FB_i(t))+\epsilon,\quad \epsilon\sim \mathcal{N}(0,\sigma_F^2) $$

v1初期：
- $\kappa_F=1.0$
- $\sigma_F=0.15$

---

## 10. スポンサー数モデル（v1 係数確定）

### 10.1 基本式

$$ SponsorRev_{next}=N_{next}\cdot P_{sponsor} $$

- v1：$P_{sponsor}=5,000,000$円/社（単一）
- 将来拡張：tier（大口/中小）をDB構造で持てるようにする（v1では1種類のみ使用）

$$ N_{next}=N^{exist}_{next}+N^{new}_{next} $$

### 10.2 営業配分（四半期）

- 四半期 $q$ の新規配分：$\rho^{new}_q$
- 既存配分：$1-\rho^{new}_q$
- 月次費用配賦：
  $$ RetSpend(t)=(1-\rho^{new}_q)SalesSpend(t),\quad NewSpend(t)=\rho^{new}_q SalesSpend(t) $$
- 人員も連続配賦：
  $$ RetStaff(t)=(1-\rho^{new}_q)SalesStaff,\quad NewStaff(t)=\rho^{new}_q SalesStaff $$

### 10.3 月次「有効営業努力」（人の影響を大きく）

$$ E^{ret}(t)=w_s^{ret}RetStaff(t)+w_m^{ret}\frac{RetSpend(t)}{10^6} $$
$$ E^{new}(t)=w_s^{new}NewStaff(t)+w_m^{new}\frac{NewSpend(t)}{10^6} $$

v1係数（要望反映）：
- $w_s^{ret}=1.4, w_m^{ret}=0.12$
- $w_s^{new}=1.6, w_m^{new}=0.08$

### 10.4 累積営業努力（EWMA、既存/新規でλ分離）

$$ C^{ret}(t)=(1-\lambda_{ret})C^{ret}(t-1)+\lambda_{ret}E^{ret}(t) $$
$$ C^{new}(t)=(1-\lambda_{new})C^{new}(t-1)+\lambda_{new}E^{new}(t) $$

v1：
- $\lambda_{ret}=0.12$
- $\lambda_{new}=0.05$（新規は気長＝減衰弱い）

### 10.5 既存スポンサー数（脱落率）

$$ N^{exist}_{next}=round(N_{this}(1-Churn)) $$
$$ Churn=clip\Big( c_0-c_1\ln(1+C^{ret}(7月)) -c_2(\overline{Perf}_{this}-0.5) -c_3(FanGrowth_{this}) ,\ c_{min},c_{max} \Big) $$

v1係数：
- $c_0=0.22, c_1=0.05, c_2=0.06, c_3=0.04$
- $c_{min}=0.05, c_{max}=0.45$

※FanGrowth は内部はFBで計算（表示はしない）

### 10.6 新規スポンサー数（見込み顧客×成約率）

見込み顧客数：
$$ L=round\Big( L_0+\ell_1\ln(1+C^{new}(7月)) +\ell_2\ln(1+N_{this}) +\ell_3(\overline{Perf}^{past}-0.5) +\ell_4\ln(1+Followers(7月)) \Big) $$

v1係数：
- $L_0=8, \ell_1=4.0, \ell_2=1.2, \ell_3=2.0, \ell_4=0.8$

成約率：
$$ p=\sigma\Big( a_0+a_1\ln(1+C^{new}(7月)) +a_2(\overline{Perf}_{this}-0.5) +a_3\ln(1+Followers(7月)) \Big) $$

v1係数：
- $a_0=-2.0, a_1=0.55, a_2=0.45, a_3=0.10$

新規契約数（確率）：
$$ N^{new}_{next}\sim Binomial(L,p) $$

### 10.7 内定進捗（4〜7月、上限保証・速度自然）

- 4〜6月：残りから抽選（B方式）
- 7月：残りを強制確定

月 $m \in \{4,5,6\}$：
$$ \Delta(m)\sim Binomial(R(m),q_m),\quad R(m)=N_{next}-C(m-1) $$
$$ C(m)=C(m-1)+\Delta(m) $$

7月：
$$ \Delta(7)=R(7)\Rightarrow C(7)=N_{next} $$

v1の確定確率（例）：
- 既存：$q^{exist}_4=0.40, q^{exist}_5=0.35, q^{exist}_6=0.30$
- 新規：$q^{new}_4=0.15, q^{new}_5=0.25, q^{new}_6=0.35$

UI表示：
- 4〜6月：内定累計（既存/新規/合計）＋増分
- 7月：最終確定（既存/新規/合計）＋次年度スポンサー収入見込み（※入金は8月）

---

## 11. 人員・採用・解雇（v1）

### 11.1 ポジション

- 営業、ホームタウン、運営、プロモーション、管理、強化、アカデミー
- ゲーム開始時：各ポジション1人（0にはできない）

### 11.2 人件費

- 人件費＝人数×単価（単価は固定：例500万円/年）
- 12ヶ月均等計上

### 11.3 採用

- 採用イベント：5月のみ
- 翌年度開始（8月）に入社（原則）
- 採用は確率で成功/人数決定（採用成功率は隠れ変数。`show hiring_chance`は無し）

### 11.4 解雇

- 解雇可能：5月のみ
- 退職金：年収の半年〜1年分（v1は0.75年分を標準値として実装し、将来分布化可）
- 解雇累積（最近重視）に応じ、翌年以降の採用成功率にペナルティ（隠れ変数）
- 人員変動履歴は `show staff_history` で参照可能

---

## 12. アカデミー（v1）

- 年次投資額を決定（5月イベントで翌年度分設定）
- 支出は12分割で毎月
- 勝率（TP）に正の影響（TP式の $\beta$ 部分）
- 移籍金収入：年1回（7月）、累積投資に応じた確率で発生（詳細分布はv1簡易でOK）

---

## 13. 画面（代表月）に関する凍結事項（v1）

### 13.1 試合結果画面（節終了）

- 「全試合結果」には各試合の 天候と入場者数を付与
- 自クラブ試合詳細には：
    - 得点/失点、天候
    - ホーム入場者・アウェイ入場者・合計
    - チケット収入、物販収入、物販費用、試合運営費、試合損益
- 全試合結果リストは 自クラブの試合を最上段に表示

### 13.2 5月（シーズン最終月）順位表の追加表示

- 1位「優勝」、2位「準優勝」を横に表示
- 各クラブの平均入場者数（ホームゲーム平均）を順位表に追加

### 13.3 12月公開イベント画面（重要）

- 全クラブ公開：前期財務サマリー（PL/BS簡易）、チーム力指標（最新）
- 自クラブ表示（スポンサー）：当年度スポンサー数のみ（次年度内定は表示しない）

---

## 14. ペナルティ（v1固定値）

### 14.1 債務超過ペナルティ（年度内）

- 勝点剥奪：-6点（v1固定。年度内の負担として十分大きい）
- 追加強化費（12月の追加補強）禁止
- （任意オプション）最下位ペナルティ：次年度配分金ゼロ（ON/OFF設定）

---

## 15. v1 係数一覧（実装用まとめ）

### 15.1 試合勝敗

- $h=3$
- $k=0.15$
- $d_0=0.30, c=0.08$

### 15.2 TP（強さ）

- $\alpha=10, \beta=1, \rho=0.5$

### 15.3 入場（固定）

- $Pop=1,000,000 / Cap=20,000$
- $f(0)=0.06, f_{max}=0.25$
- $\bar P=2,500$
- 天候：晴0.55/曇0.30/雨0.15、$g_W$：晴0/曇-0.2/雨-0.6
- アウェイ：$r^{away}_0=0.018, \kappa_W=0.20, q_{max}=0.20$

### 15.4 ホーム来場率

- $FB_{ref}=60,000, S_{promo}=10,000,000$
- $\beta_0=-1.986, \beta_W=1.0, \beta_1=0.8, \beta_2=0.4, \beta_3=0.6, \beta_4=0.3, \beta_5=0.5$
- $g_{event}=0.4$（開幕/最終）

### 15.5 FB成長

- $\lambda=0.10, \phi=0.00002$
- $S_{promo-growth}=50M, S_{ht-growth}=50M$
- $g_0=-0.002, a_1=0.006, a_2=0.006, a_3=0.010, a_4=0.006$

### 15.6 公開ファン指標

- $\kappa_F=1.0, \sigma_F=0.15$

### 15.7 スポンサー（営業努力）

- $P_{sponsor}=5,000,000$
- $w_s^{ret}=1.4, w_m^{ret}=0.12$
- $w_s^{new}=1.6, w_m^{new}=0.08$
- $\lambda_{ret}=0.12, \lambda_{new}=0.05$
- Churn：$c_0=0.22, c_1=0.05, c_2=0.06, c_3=0.04, c_{min}=0.05, c_{max}=0.45$
- Leads：$L_0=8, \ell_1=4.0, \ell_2=1.2, \ell_3=2.0, \ell_4=0.8$
- Conv：$a_0=-2.0, a_1=0.55, a_2=0.45, a_3=0.10$
- 内定進捗：既存 $q_4=0.40, q_5=0.35, q_6=0.30$／新規 $q_4=0.15, q_5=0.25, q_6=0.35$、7月は強制確定

---

## 16. 実装に向けた「凍結ライン」明確化（v1）

### 凍結（実装中に変えない）

- 時間軸・イベント（8/12/6/7の意味）
- 非同期ターン＋Y/N遷移
- 公開/非公開の境界（FB隠し、Fan指標公開、スポンサー要因は非公開）
- モデル骨格（勝敗・入場・スポンサー・FB成長・内定進捗B方式）
- 参照コマンド群（上記リスト）

### 調整（プレイテストで変える）

- 係数（β群、スポンサー係数、q_m、ペナルティの強さ）
- スコア分布（得点モデルの細部）
- UI文言・レイアウト

---

## 追記1：得点モデル詳細

### 得点モデル ver.1（確定版）

#### 前提

- 先に勝敗 $R \in \{\text{H-win}, \text{draw}, \text{A-win}\}$ が確定済み
- 有効レーティング差 $\Delta=\text{ER}_{\text{home}}-\text{ER}_{\text{away}}$ は既に計算済み
- スコアは最大4点（0〜4の範囲内）

---

#### 1) スコア候補（最大4点）

**ホーム勝ち候補集合 $W$**

$$ W=\{(1,0),(2,0),(2,1),(3,0),(3,1),(3,2),(4,0),(4,1)\} $$

初期重み（例）：
- 1–0: 0.22 / 2–1: 0.22 / 2–0: 0.16
- 3–1: 0.14 / 3–0: 0.10 / 3–2: 0.06
- 4–1: 0.06 / 4–0: 0.04

**引き分け候補集合 $D$**

$$ D=\{(0,0),(1,1),(2,2),(3,3)\} $$

初期重み（例）：
- 0–0: 0.22 / 1–1: 0.58 / 2–2: 0.17 / 3–3: 0.03

**アウェイ勝ち候補集合 $A$**

ホーム勝ちを左右反転：
$$ A=\{(0,1),(0,2),(1,2),(0,3),(1,3),(2,3),(0,4),(1,4)\} $$
重みは $W$ と対応させて同じ。

---

#### 2) 実力差で「点差がつきやすい」を反映（簡単・調整容易）

スコア $(g_H,g_A)$ の点差を
$$ m=|g_H-g_A| $$
とし、補正用の $z$ を
$$ z=\min\left(\frac{|\Delta|}{12},1\right) $$
で作ります。

各候補の重み $w$ を、次で補正：
$$ w' = w \cdot \exp\left(\lambda\cdot (m-1)\cdot z\right) $$

- 初期値：$\lambda=0.08$

最後に正規化：
$$ p_j=\frac{w'_j}{\sum_k w'_k} $$

---

#### 3) 実装手順（1試合）

1. 勝敗 $R$ に応じて候補集合（$W,D,A$）を選ぶ
2. $\Delta$ から $z$ を計算
3. 各候補の重みを $w'$ に補正し、正規化して確率 $p_j$ を作る
4. 乱数で1つ抽選してスコア確定（最大4点の範囲内）
